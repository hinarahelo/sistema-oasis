<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Painel da CoordenaÃ§Ã£o â€” Oasis</title>
  <link rel="stylesheet" href="style.css">
</head>

<body class="bg-paper official">

<script>
  const usuario = JSON.parse(localStorage.getItem("usuario"));
  if (!usuario || usuario.nivel !== "coordenacao") location.href = "index.html";
</script>

<header class="header official">
  <img src="logo-oasis.png" class="logo">
  <div class="header-text">
    <h1>ðŸ‘‘ CoordenaÃ§Ã£o</h1>
    <span>Supremo Tribunal de Oasis</span>
  </div>
</header>

<nav class="nav-bar sidebar official">
  <button onclick="mostrarAba('tickets')">ðŸ“‚ Tickets</button>
  <button onclick="mostrarAba('logs')">ðŸ“œ Logs</button>
  <button onclick="sair()">ðŸšª Sair</button>
</nav>

<main class="content official">

<section id="tickets" class="aba active">
  <h2>Controle Geral</h2>
  <div id="listaTickets"></div>
</section>

<section id="logs" class="aba">
  <h2>Auditoria</h2>
  <div id="listaLogs"></div>
</section>

</main>

<script type="module">
import { collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { db } from "./firebase.js";

window.mostrarAba = id => {
  document.querySelectorAll(".aba").forEach(a => a.classList.remove("active"));
  document.getElementById(id).classList.add("active");
};
window.sair = () => {
  localStorage.clear();
  location.href = "index.html";
};

onSnapshot(collection(db,"tickets"), snap => {
  const box = document.getElementById("listaTickets");
  box.innerHTML = "";
  snap.forEach(d => {
    const t = d.data();
    box.innerHTML += `
      <div class="price-card">
        <strong>${t.categoria} â€” ${t.nome} ${t.cid}</strong><br>
        Status: ${t.status}
      </div>`;
  });
});

onSnapshot(collection(db,"logs"), snap => {
  const box = document.getElementById("listaLogs");
  box.innerHTML = "";
  snap.forEach(d => {
    const l = d.data();
    box.innerHTML += `
      <div class="price-card">
        ${l.acao}<br>
        ${l.usuario} â€” ${l.cid}
      </div>`;
  });
});
</script>
</body>
</html>
