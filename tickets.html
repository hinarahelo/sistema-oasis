<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Tickets â€¢ Oasis</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .aba { display:none; }
    .aba.active { display:block; }
    .topbar {
      display:flex; justify-content:space-between; align-items:center;
      margin-bottom:10px;
    }
    .loader {
      display:none; text-align:center; margin-top:20px;
    }
  </style>
</head>
<body class="dark">

<script>
  // ProteÃ§Ã£o de acesso
  let usuario = null;
  try {
    usuario = JSON.parse(localStorage.getItem("usuario"));
    if (!usuario || !usuario.nivel) throw new Error();
  } catch {
    location.href = "https://sistema-oasis-auth.hinarahelo.workers.dev/login";
  }

  function logout() {
    localStorage.removeItem("usuario");
    location.href = "index.html";
  }
</script>

<div class="layout">
  <aside class="sidebar">
    <h2>ğŸ« Atendimento</h2>
    <button onclick="abrirAba('solicitacoes')">ğŸ›’ SolicitaÃ§Ãµes</button>
    <button onclick="abrirAba('historico')">ğŸ§¾ HistÃ³rico</button>

    <script>
      if (usuario.nivel === "juridico" || usuario.nivel === "coordenacao") {
        document.write(`<a href="staff/dashboard.html">ğŸ‘® Painel Staff</a>`);
      }
    </script>

    <button onclick="logout()" style="margin-top:15px;">ğŸšª Sair</button>
  </aside>

  <main class="content">
    <div class="topbar">
      <h2>Bem-vindo, <span id="user-nome"></span></h2>
    </div>

    <div class="loader" id="loader">Carregando...</div>

    <section id="solicitacoes" class="aba active">
      <h3>ğŸ›’ SolicitaÃ§Ãµes</h3>
      <div class="processos">
        <button onclick="abrirSolicitacao('Troca de Nome')">ğŸ“œ Troca de Nome</button>
        <button onclick="abrirSolicitacao('AdoÃ§Ã£o')">ğŸ‘¶ AdoÃ§Ã£o</button>
        <button onclick="abrirSolicitacao('Jovem Aprendiz')">ğŸ§‘â€ğŸ“ Jovem Aprendiz</button>
        <button onclick="abrirSolicitacao('Nascimento')">ğŸ‘¼ Nascimento</button>
        <button onclick="abrirSolicitacao('Porte de Arma')">ğŸ”« Porte de Arma</button>
        <button onclick="abrirSolicitacao('Limpeza de Ficha')">ğŸ§¹ Limpeza de Ficha</button>
      </div>
    </section>

    <section id="historico" class="aba">
      <h3>ğŸ§¾ Meus Tickets</h3>
      <ul id="lista-historico"></ul>
    </section>

    <section id="chat" class="aba">
      <h3 id="chat-titulo"></h3>
      <div id="mensagens"></div>
      <textarea id="mensagem" placeholder="Digite sua mensagem..."></textarea>
      <button onclick="enviarMensagem()">Enviar</button>
    </section>
  </main>
</div>

<script>
  document.getElementById("user-nome").innerText = usuario.nome;
</script>
<script type="module" src="script.js"></script>
</body>
</html>
